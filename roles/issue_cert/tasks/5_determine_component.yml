---
- name: Check if automation-eda-controller.service is active
  ansible.builtin.systemd:
    name: automation-eda-controller.service
    state: started
  register: eda_status
  ignore_errors: true

- name: Check if automation-controller.service is active
  ansible.builtin.systemd:
    name: automation-controller.service
    state: started
  register: controller_status
  ignore_errors: true

- name: Determine running service
  ansible.builtin.set_fact:
    aap_component: >-
      {% if eda_status.status == "running" %}
        automation-eda-controller
      {% elif controller_status.status == "running" %}
        automation-controller
      {% else %}
        none
      {% endif %}
